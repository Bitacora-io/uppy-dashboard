{"version":3,"names":["classNames","require","h","FileItem","VirtualList","chunks","list","size","chunked","currentChunk","forEach","item","length","push","module","exports","props","noFiles","totalFileCount","dashboardFilesClass","rowHeight","fileProps","id","error","i18n","uppy","acquirers","resumableUploads","individualCancellation","hideRetryButton","hidePauseResumeButton","hideCancelButton","showLinkToFileUploadResult","showRemoveButtonAfterComplete","isWide","metaFields","recoveredState","toggleFileCard","handleRequestThumbnail","handleCancelThumbnail","sortByGhostComesFirst","file1","file2","files","isGhost","Object","keys","sort","rows","itemsPerRow","renderRow","row","map","fileID","openFileEditor","canEditFile","toggleAddFilesPanel"],"sources":["FileList.js"],"sourcesContent":["const classNames = require('classnames')\nconst { h } = require('preact')\nconst FileItem = require('./FileItem/index.js')\nconst VirtualList = require('./VirtualList')\n\nfunction chunks (list, size) {\n  const chunked = []\n  let currentChunk = []\n  list.forEach((item) => {\n    if (currentChunk.length < size) {\n      currentChunk.push(item)\n    } else {\n      chunked.push(currentChunk)\n      currentChunk = [item]\n    }\n  })\n  if (currentChunk.length) chunked.push(currentChunk)\n  return chunked\n}\n\nmodule.exports = (props) => {\n  const noFiles = props.totalFileCount === 0\n  const dashboardFilesClass = classNames(\n    'uppy-Dashboard-files',\n    { 'uppy-Dashboard-files--noFiles': noFiles },\n  )\n\n  // It's not great that this is hardcoded!\n  // It's ESPECIALLY not great that this is checking against `itemsPerRow`!\n  const rowHeight = 71\n\n  const fileProps = {\n    // FIXME This is confusing, it's actually the Dashboard's plugin ID\n    id: props.id,\n    error: props.error,\n    // TODO move this to context\n    i18n: props.i18n,\n    uppy: props.uppy,\n    // features\n    acquirers: props.acquirers,\n    resumableUploads: props.resumableUploads,\n    individualCancellation: props.individualCancellation,\n    // visual options\n    hideRetryButton: props.hideRetryButton,\n    hidePauseResumeButton: props.hidePauseResumeButton,\n    hideCancelButton: props.hideCancelButton,\n    showLinkToFileUploadResult: props.showLinkToFileUploadResult,\n    showRemoveButtonAfterComplete: props.showRemoveButtonAfterComplete,\n    isWide: props.isWide,\n    metaFields: props.metaFields,\n    recoveredState: props.recoveredState,\n    // callbacks\n    toggleFileCard: props.toggleFileCard,\n    handleRequestThumbnail: props.handleRequestThumbnail,\n    handleCancelThumbnail: props.handleCancelThumbnail,\n  }\n\n  const sortByGhostComesFirst = (file1, file2) => {\n    return props.files[file2].isGhost - props.files[file1].isGhost\n  }\n\n  // Sort files by file.isGhost, ghost files first, only if recoveredState is present\n  const files = Object.keys(props.files)\n  if (props.recoveredState) files.sort(sortByGhostComesFirst)\n  const rows = chunks(files, props.itemsPerRow)\n\n  const renderRow = (row) => (\n    // The `role=\"presentation` attribute ensures that the list items are properly\n    // associated with the `VirtualList` element.\n    // We use the first file ID as the keyâ€”this should not change across scroll rerenders\n    <div role=\"presentation\" key={row[0]}>\n      {row.map((fileID) => (\n        <FileItem\n          key={fileID}\n          uppy={props.uppy}\n          {...fileProps}\n          role=\"listitem\"\n          openFileEditor={props.openFileEditor}\n          canEditFile={props.canEditFile}\n          toggleAddFilesPanel={props.toggleAddFilesPanel}\n          file={props.files[fileID]}\n        />\n      ))}\n    </div>\n  )\n\n  return (\n    <VirtualList\n      class={dashboardFilesClass}\n      role=\"list\"\n      data={rows}\n      renderRow={renderRow}\n      rowHeight={rowHeight}\n    />\n  )\n}\n"],"mappings":"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"}